<!DOCTYPE html> <html> 	<head> 		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 		<script type="text/javascript" src="./../../OneDrive_Web_js/J0909.js"></script> 		<script type="text/javascript" src="../reading/functions.js"></script> 		<link rel="stylesheet" href="../reading/layout.css"> 	</head> 	<body onload='f2();' onkeydown='f4()' oncontextmenu="return false" onselectstart="return false" oncopy="return false" oncut="return false" onpaste="return false" draggable="false" ondragstart="return false" ondrop="return false"> 		<div id = "container"> 			<div id = "titleBox"></div> 			<div id = "navigationBox"></div>  			<div id = "contentBox"> 				<h4>문제</h4> 				<pre style='white-space:normal;'>MLP 코드의 일부입니다 이를 해결하는 다음 프로그램을 해석하세요 </pre> 				 	  				<h4>알고리즘</h4> 				<pre style='white-space:normal;'> <br></pre> 		 				<br><h4>프로그램 코드 <input id='btn' type='button' value='실행순서 및 메모리상태 확인' onclick='f5();'/></h4>  				<div id = "codeBox"><pre id="code0" class="unselectable codeClass">	import numpy as np 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	# 시그모이드 함수 
</pre><pre id="code0" class="unselectable codeClass">	def actf삭제(x): 
</pre><pre id="code0" class="unselectable codeClass">		return 1/(1+np.<font color='red' title="">exp</font>(-x)) 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	# 시그모이드 함수의 미분값 
</pre><pre id="code0" class="unselectable codeClass">	def actf_deriv삭제( x ): 
</pre><pre id="code0" class="unselectable codeClass">		    return x*(1-x) 
</pre><pre id="code0" class="unselectable codeClass">	     
</pre><pre id="code0" class="unselectable codeClass">	# XOR 연산을 위한 4행*2열의 입력 행렬 
</pre><pre id="code0" class="unselectable codeClass">	# 마지막 열은 바이어스를 나타낸다.  
</pre><pre id="code0" class="unselectable codeClass">	X = np.array([[0,0,1], [0,1,1], [1,0,1], [1,1,1]]) 
</pre><pre id="code0" class="unselectable codeClass">	                 
</pre><pre id="code0" class="unselectable codeClass">	# XOR 연산을 위한 4행*1열의 목표 행렬 
</pre><pre id="code0" class="unselectable codeClass">	y = np.array([[0], [1], [1], [0]]) 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	np.random.seed(5) 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	inputs = 3	# 입력층의 노드 개수 
</pre><pre id="code0" class="unselectable codeClass">	hiddens = 6	# 은닉층의 노드 개수 
</pre><pre id="code0" class="unselectable codeClass">	outputs = 1	# 출력층의 노드 개수 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	# 가중치를 ?1.0에서 1.0 사이의 난수로 초기화한다. 
</pre><pre id="code0" class="unselectable codeClass">	weight0삭제 = 2*np.random.random((inputs, hiddens))-1    
</pre><pre id="code0" class="unselectable codeClass">	weight1삭제 = 2*np.random.random((hiddens, outputs))-1   
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	# 반복한다.  
</pre><pre id="code0" class="unselectable codeClass">	for i in range(10000): 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	    # 순방향 계산 
</pre><pre id="code0" class="unselectable codeClass">	    layer0삭제 = X				# 입력을 layer0에 대입한다.  
</pre><pre id="code0" class="unselectable codeClass">	    net1삭제 = np.<font color='red' title="">dot</font>( <font color='red' title="">layer0</font>, <font color='red' title="">weight0</font> )	# 행렬의 곱을 계산한다.  
</pre><pre id="code0" class="unselectable codeClass">	    layer1삭제 = <font color='red' title="">actf</font>( <font color='red' title="">net1</font> )		# 활성화 함수를 적용한다.  
</pre><pre id="code0" class="unselectable codeClass">	    <font color='red' title="">layer1</font>[:,-1] = 1.0      	#  마지막 열은 바이어스를 나타낸다. 1.0으로 만든다. 
</pre><pre id="code0" class="unselectable codeClass">	    net2삭제 = np.<font color='red' title="">dot</font>( <font color='red' title="">layer1</font>, <font color='red' title="">weight1</font> )	# 행렬의 곱을 계산한다.  
</pre><pre id="code0" class="unselectable codeClass">	    layer2삭제 = <font color='red' title="">actf</font>( <font color='red' title="">net2</font> )		# 활성화 함수를 적용한다.  
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	    # 출력층에서의 오차를 계산한다.  
</pre><pre id="code0" class="unselectable codeClass">	    layer2_error삭제 = <font color='red' title="">layer2</font> - y 
</pre><pre id="code0" class="unselectable codeClass">	         
</pre><pre id="code0" class="unselectable codeClass">	    # 출력층에서의 델타값을 계산한다.  
</pre><pre id="code0" class="unselectable codeClass">	    layer2_delta삭제 = <font color='red' title="">layer2_error</font> * <font color='red' title="">actf_deriv</font>( <font color='red' title="">layer2</font> ) 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	    # 은닉층에서의 오차를 계산한다. 
</pre><pre id="code0" class="unselectable codeClass">	    # 여기서 T는 행렬의 전치를 의미한다.  
</pre><pre id="code0" class="unselectable codeClass">	    # 역방향으로 오차를 전파할 때는 반대방향이므로 행렬이 전치되어야 한다.  
</pre><pre id="code0" class="unselectable codeClass">	    layer1_error삭제 = np.<font color='red' title="">dot</font>( <font color='red' title="">layer2_delta</font>, <font color='red' title="">weight1</font>.T ) 
</pre><pre id="code0" class="unselectable codeClass">	     
</pre><pre id="code0" class="unselectable codeClass">	    # 은닉층에서의 델타를 계산한다. 
</pre><pre id="code0" class="unselectable codeClass">	    layer1_delta삭제 = <font color='red' title="">layer1_error</font> * <font color='red' title="">actf_deriv</font>( <font color='red' title="">layer1</font> ) 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	    # 은닉층->출력층을 연결하는 가중치를 수정한다.  
</pre><pre id="code0" class="unselectable codeClass">	    <font color='red' title="">weight1</font> += -0.2*np.<font color='red' title="">dot</font>( <font color='red' title="">layer1</font>.T, <font color='red' title="">layer2_delta</font> ) 
</pre><pre id="code0" class="unselectable codeClass">	 
</pre><pre id="code0" class="unselectable codeClass">	    # 입력층->은닉층을 연결하는 가중치를 수정한다.  
</pre><pre id="code0" class="unselectable codeClass">	    <font color='red' title="">weight0</font> += -0.2*np.<font color='red' title="">dot</font>( <font color='red' title="">layer0</font>.T, <font color='red' title="">layer1_delta</font> ) 
</pre><pre id="code0" class="unselectable codeClass">	print( <font color='red' title="">layer2</font> )			# 현재 출력층의 값을 출력한다. 
</pre></div>	 	 				<br><h4>키워드 설명</h4> 				<pre id = "d3" style='white-space:normal;'></pre> 			 				<h4>실행 순서</h4> 				<pre id = "d4" style='white-space:normal; width:800px;'> </pre> 				<pre style='white-space:normal;'> 					※ 실행순서 및 메모리상태는 A키(이전)및 D키(다음)를 눌러도 확인할 수 있습니다  				</pre> 				<br><br> 			</div> 			<div id = "floatingBox"> 				<pre id = "outputBox" class ="outputBox"></pre>  				<div id = "intermediateResult"> 					<img id = "d7"> 					<table style = "border-spacing:0px;margin:0px;table-layout:auto;"> 						<tbody id = "d8"></tbody> 					</table> 				</div> 			</div> 		</div> 	</body> </html> 
